(function(){"use strict";const o=window.Vue;function m(){return window.panel}function $(){return m().api}function y(){return m().app}function h(){const n=$();return{load:({parent:t,name:s})=>n.get(`${t}/sections/${s}`)}}const l=o.computed;o.customRef,o.defineAsyncComponent,o.defineComponent,o.effectScope,o.getCurrentInstance,o.getCurrentScope,o.h,o.inject,o.isProxy,o.isReactive,o.isReadonly,o.isRef,o.isShallow,o.markRaw,o.nextTick,o.onActivated,o.onBeforeMount,o.onBeforeUnmount,o.onBeforeUpdate,o.onDeactivated,o.onErrorCaptured;const k=o.onMounted;o.onRenderTracked,o.onRenderTriggered,o.onScopeDispose,o.onServerPrefetch;const b=o.onUnmounted;o.onUpdated,o.provide,o.proxyRefs,o.reactive,o.readonly;const d=o.ref;o.shallowReactive,o.shallowReadonly,o.shallowRef,o.toRaw,o.toRef,o.toRefs,o.triggerRef,o.unref,o.useAttrs,o.useCssModule,o.useCssVars,o.useListeners,o.useSlots;const R=o.watch;o.watchEffect,o.watchPostEffect,o.watchSyncEffect;const S={blueprint:String,lock:[Boolean,Object],help:String,name:String,parent:String,timestamp:Number};function f(n,e,t,s,a,c,u,v){var _=typeof n=="function"?n.options:n;return e&&(_.render=e,_.staticRenderFns=t,_._compiled=!0),{exports:n,options:_}}const P={__name:"heading-structure",props:S,setup(n){const e=n,t=m(),{load:s}=h(),a=d(null),c=l(()=>{var i;return(i=a.value)==null?void 0:i.some((p,g)=>{var r;return p.level>(((r=a.value[g-1])==null?void 0:r.level)??0)+1})}),u=l(()=>{var i;return((i=a.value)==null?void 0:i.filter(p=>p.level===1).length)>1}),v=l(()=>{var i;return((i=a.value)==null?void 0:i.filter(p=>p.level===1).length)===0}),_=()=>s({parent:e.parent,name:e.name}).then(i=>{a.value=i.data}),w=(i,p)=>{var g;return!!(i.level>(((g=a.value[p-1])==null?void 0:g.level)??0)+1||i.level===1&&a.value[p-1]||i.level===1&&a.value.filter(r=>r.level===1).length>1)};return k(()=>{_(),t.events.on("content.save",i=>{_()})}),b(()=>t.events.off("content.save")),{__sfc:!0,props:e,panel:t,load:s,data:a,incorrectOrder:c,multipleH1:u,noH1:v,handleLoad:_,itemInvalid:w}}};var x=function(){var e=this,t=e._self._c,s=e._self._setupProxy;return s.data?t("div",{staticClass:"k-section k-heading-structure"},[t("div",{staticClass:"k-field-header k-heading-structure__label k-label k-field-label"},[t("k-icon",{attrs:{type:"headline"}}),t("span",{staticClass:"k-label-text"},[e._v(e._s(s.props.label||e.$t("seo.sections.headingStructure.title")))])],1),t("k-box",{attrs:{theme:"white"}},[t("ol",{staticClass:"k-heading-structure__list"},e._l(s.data,function(a,c){return t("li",{key:c,class:`k-heading-structure__item level-${a.level} ${s.itemInvalid(a,c)?"is-invalid":""}`,style:`z-index: ${s.data.length-c}`},[t("span",{staticClass:"k-heading-structure__item__level"},[e._v(" H"+e._s(a.level)+" ")]),t("span",{staticClass:"k-heading-structure__item__text"},[e._v(e._s(a.text))])])}),0)]),s.incorrectOrder&&!s.noH1?t("k-box",{staticClass:"k-heading-structure__notice",attrs:{theme:"negative"}},[t("k-icon",{attrs:{type:"alert"}}),t("k-text",[e._v(e._s(e.$t("seo.sections.headingStructure.errors.incorrectOrder")))])],1):e._e(),s.multipleH1?t("k-box",{staticClass:"k-heading-structure__notice",attrs:{theme:"negative"}},[t("k-icon",{attrs:{type:"alert"}}),t("k-text",[e._v(e._s(e.$t("seo.sections.headingStructure.errors.multipleH1")))])],1):e._e(),s.noH1?t("k-box",{staticClass:"k-heading-structure__notice",attrs:{theme:"negative"}},[t("k-icon",{attrs:{type:"alert"}}),t("k-text",[e._v(e._s(e.$t("seo.sections.headingStructure.errors.missingH1")))])],1):e._e()],1):e._e()},I=[],H=f(P,x,I);const T=H.exports,L={__name:"facebook-preview",props:{ogTitle:String,url:String,ogDescription:String,ogImage:String},setup(n){const e=n,t=l(()=>new window.URL(e.url).host);return{__sfc:!0,props:e,host:t}}};var U=function(){var e=this,t=e._self._c,s=e._self._setupProxy;return t("div",[t("div",{staticClass:"k-facebook-preview"},[e.ogImage?t("div",{staticClass:"k-facebook-preview__image"},[t("img",{staticClass:"k-facebook-preview__img",attrs:{src:e.ogImage}})]):e._e(),t("div",{staticClass:"k-facebook-preview__content"},[t("span",{staticClass:"k-facebook-preview__url"},[e._v(e._s(s.host))]),t("span",{staticClass:"k-facebook-preview__title"},[e._v(e._s(e.ogTitle))]),t("p",{staticClass:"k-facebook-preview__description"},[e._v(e._s(e.ogDescription))])])]),t("a",{staticClass:"k-seo-preview__debugger",attrs:{href:"https://developers.facebook.com/tools/debug/","aria-label":"Facebook Sharing Debugger",target:"_blank",rel:"noopener noreferrer"}},[e._v(" "+e._s(e.$t("seo.sections.preview.openDebugger"))+" "),t("k-icon",{attrs:{type:"open"}})],1)])},V=[],Z=f(L,U,V);const M=Z.exports,F={__name:"google-preview",props:{title:String,url:String,description:String,ogSiteName:String},setup(n){const e=n,t=l(()=>new window.URL(e.url).origin),s=l(()=>new window.URL(e.url).pathname),a=l(()=>new window.URL(e.url).hostname),c=l(()=>{const u=s.value;if(!u||u==="/")return"";const v=u.split("/").filter(Boolean);return v.length===0?"":v.length===1?` › ${v[0]}`:` › … › ${v[v.length-1]}`});return{__sfc:!0,props:e,origin:t,pathname:s,domain:a,breadcrumbs:c}}};var A=function(){var e=this,t=e._self._c,s=e._self._setupProxy;return t("div",[t("div",{staticClass:"k-google-search-preview"},[t("div",{staticClass:"k-google-search-preview__header"},[t("img",{staticClass:"k-google-search-preview__favicon",attrs:{src:`https://www.google.com/s2/favicons?domain=${s.domain.value}&sz=32`,alt:`${e.ogSiteName} favicon`}}),t("div",{staticClass:"k-google-search-preview__site-info"},[t("span",{staticClass:"k-google-search-preview__site-title"},[e._v(e._s(e.ogSiteName))]),t("span",{staticClass:"k-google-search-preview__url"},[e._v(" "+e._s(s.origin)+e._s(s.breadcrumbs)+" ")])])]),t("h3",{staticClass:"k-google-search-preview__title"},[e._v(e._s(e.title))]),e.description?t("p",{staticClass:"k-google-search-preview__description"},[e._v(" "+e._s(e.description)+" ")]):e._e()]),t("a",{staticClass:"k-seo-preview__debugger",attrs:{href:"https://search.google.com/search-console","aria-label":"Google Search Console",target:"_blank",rel:"noopener noreferrer"}},[e._v(" "+e._s(e.$t("seo.sections.preview.openSearchConsole"))+" "),t("k-icon",{attrs:{type:"open"}})],1)])},D=[],N=f(F,A,D);const O=N.exports,z={__name:"slack-preview",props:{ogTitle:String,ogSiteName:String,ogDescription:String,ogImage:String,url:String},setup(n){const e=n,t=l(()=>new window.URL(e.url).origin),s=l(()=>new window.URL(e.url).hostname),a=d(!0);return{__sfc:!0,props:e,origin:t,domain:s,showImage:a}}};var B=function(){var e=this,t=e._self._c,s=e._self._setupProxy;return t("div",{staticClass:"k-slack-preview"},[t("div",{staticClass:"k-slack-preview__content"},[t("div",{staticClass:"k-slack-preview__site-name"},[t("img",{staticClass:"k-slack-preview__favicon",attrs:{src:`https://www.google.com/s2/favicons?domain=${s.domain}&sz=16`,alt:`${e.ogSiteName} favicon`}}),e._v(" "+e._s(e.ogSiteName||s.origin)+" ")]),t("span",{staticClass:"k-slack-preview__title"},[e._v(e._s(e.ogTitle))]),t("p",{staticClass:"k-slack-preview__description"},[e._v(" "+e._s(e.ogDescription)+" "),e.ogImage?t("button",{staticClass:"k-slack-preview__image-toggle",on:{click:function(a){s.showImage=!s.showImage}}},[e._v(" "+e._s(s.showImage?"▼":"▶")+" ")]):e._e()])]),e.ogImage&&s.showImage?t("div",{staticClass:"k-slack-preview__image"},[t("img",{attrs:{src:e.ogImage}})]):e._e()])},E=[],j=f(z,B,E);const G=j.exports,q={__name:"seo-preview",props:S,setup(n){const e=n,t=m(),s=y(),{load:a}=h(),c=d(null),u=d([]),v=l(()=>e.parent==="site"),_=l(()=>{var r;return e.label||((r=t==null?void 0:t.t)==null?void 0:r.call(t,"seo.sections.preview.title"))||"Preview"}),w=l(()=>{var C;const r=(C=c.value)==null?void 0:C.pageTitle;if(v.value&&r){const X=r.replaceAll('"','\\"');return`${_.value} (shows "${X}")`}return _.value}),i=d(window.localStorage.getItem("kSEOPreviewType")??"google");R(i,r=>{window.localStorage.setItem("kSEOPreviewType",r)});const p=()=>{a({parent:e.parent,name:e.name}).then(r=>{c.value=r.meta,u.value=r.options,!window.localStorage.getItem("kSEOPreviewType")&&r.options.length>0&&(i.value=r.options[0].value)})},g=()=>{var r;(r=c.value)!=null&&r.panelUrl&&s.$go(c.value.panelUrl)};return k(()=>{p(),t.events.on("content.save",r=>{p()})}),b(()=>t.events.off("content.save")),{__sfc:!0,props:e,panel:t,app:s,load:a,meta:c,options:u,isSiteParent:v,baseLabel:_,headerLabel:w,type:i,handleLoad:p,openPanelTarget:g,FacebookPreview:M,GooglePreview:O,SlackPreview:G}}};var J=function(){var a;var e=this,t=e._self._c,s=e._self._setupProxy;return t("div",{staticClass:"k-section k-seo-preview"},[t("div",{staticClass:"k-field-header k-seo-preview__label k-label k-field-label"},[t("k-icon",{attrs:{type:"preview"}}),t("span",{staticClass:"k-label-text"},[e._v(" "+e._s(s.headerLabel)+" ")]),s.isSiteParent&&((a=s.meta)!=null&&a.panelUrl)?t("k-button",{staticClass:"k-seo-preview__panel-button",attrs:{variant:"filled",size:"xs",icon:"edit"},on:{click:s.openPanelTarget}},[e._v(" View page in panel ")]):e._e()],1),t("k-select-field",{attrs:{type:"select",name:"seo-preview-type",before:e.$t("seo.sections.preview.showFor"),options:s.options,required:!0,empty:!1},model:{value:s.type,callback:function(c){s.type=c},expression:"type"}}),s.meta?t("div",{staticClass:"k-seo-preview__inner"},[s.type==="google"?t(s.GooglePreview,e._b({},"google-preview",s.meta,!1)):e._e(),s.type==="facebook"?t(s.FacebookPreview,e._b({},"facebook-preview",s.meta,!1)):e._e(),s.type==="slack"?t(s.SlackPreview,e._b({},"slack-preview",s.meta,!1)):e._e()],1):e._e()],1)},K=[],Q=f(q,J,K);const W=Q.exports;panel.plugin("tobimori/seo",{icons:{robots:'<path d="M13.5 2c0 .444-.193.843-.5 1.118V5h5a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V8a3 3 0 0 1 3-3h5V3.118A1.5 1.5 0 1 1 13.5 2ZM6 7a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1H6Zm-4 3H0v6h2v-6Zm20 0h2v6h-2v-6ZM9 14.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm6 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z" />',"robots-off":'<path fill-rule="evenodd" clip-rule="evenodd" d="M21 16.786V8a3 3 0 0 0-3-3h-5V3.118a1.5 1.5 0 1 0-2 0V5H9.214l2 2H18a1 1 0 0 1 1 1v6.786l2 2ZM2.093 3.507l2.099 2.099A2.995 2.995 0 0 0 3 8v10a3 3 0 0 0 3 3h12c.463 0 .902-.105 1.293-.292l1.9 1.9 1.414-1.415-6.88-6.88a1.5 1.5 0 1 0-2.04-2.04L3.508 2.093 2.093 3.507ZM5 8a1 1 0 0 1 .65-.937L17.585 19H6a1 1 0 0 1-1-1V8Zm-5 2h2v6H0v-6Zm24 0h-2v6h2v-6Zm-13.5 3a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z" />'},sections:{"heading-structure":T,"seo-preview":W}})})();
