(function(){"use strict";function d(r,e,t,s,n,o,u,_){var i=typeof r=="function"?r.options:r;return e&&(i.render=e,i.staticRenderFns=t,i._compiled=!0),{exports:r,options:i}}const y={extends:"k-writer-field"};var T=function(){var e=this,t=e._self._c;return t("k-field",e._b({class:["k-writer-field",e.$attrs.class],style:e.$attrs.style,attrs:{counter:e.counterOptions,input:e.id}},"k-field",e.$props,!1),[t("k-input",e._b({ref:"input",attrs:{after:e.after,before:e.before,icon:e.icon,type:"seo-writer"},on:{input:function(s){return e.$emit("input",s)}}},"k-input",e.$props,!1))],1)},x=[],R=d(y,T,x);const P=R.exports;var I=d({extends:"k-writer-input",methods:{createNodes(){return Vue.component("k-writer-input").options.methods.createNodes.call(this).filter(e=>e.name!=="hardBreak")}}},null,null);const V=I.exports,k=r=>{const e={theme:"blue",...r};return{get button(){var t,s;return{id:e.name,icon:e.icon,label:(s=(t=window.panel)==null?void 0:t.$t)==null?void 0:s.call(t,e.label),name:e.name,inline:!0}},get schema(){return{group:"inline",inline:!0,atom:!0,selectable:!1,attrs:{variable:{default:e.variable}},leafText:t=>`{{ ${t.attrs.variable} }}`,parseDOM:[{tag:`span[data-seo-template-variable="${e.variable}"]`,getAttrs:t=>({variable:t.dataset.seoTemplateVariable??e.variable})}],toDOM:t=>["span",{"data-seo-template-variable":t.attrs.variable},`{{ ${t.attrs.variable} }}`]}},commands({type:t}){return()=>(s,n)=>{if(!n)return!1;const{from:o,to:u}=s.selection,_=t.create({variable:e.variable}),i=s.tr;i.delete(o,u),i.insert(o,_),i.insertText(" ",o+_.nodeSize);const m=s.selection.constructor,l=o+_.nodeSize+1;return i.setSelection(m.near(i.doc.resolve(l))),n(i.scrollIntoView()),!0}},view(t){var n,o;const s=document.createElement("span");return s.className="k-seo-template-variable",s.dataset.theme=e.theme,s.dataset.seoTemplateVariable=t.attrs.variable,s.setAttribute("contenteditable","false"),s.textContent=(o=(n=window.panel)==null?void 0:n.$t)==null?void 0:o.call(n,e.label),{dom:s,update(u){var _,i;return s.dataset.seoTemplateVariable=u.attrs.variable,s.textContent=(i=(_=window.panel)==null?void 0:_.$t)==null?void 0:i.call(_,e.label),!0},ignoreMutation:()=>!0}}}},a=window.Vue;function w(){return window.panel}function H(){return w().api}function F(){return w().app}function h(){const r=H();return{load:({parent:t,name:s})=>r.get(`${t}/sections/${s}`)}}const p=a.computed;a.customRef,a.defineAsyncComponent,a.defineComponent,a.effectScope,a.getCurrentInstance,a.getCurrentScope,a.h,a.inject,a.isProxy,a.isReactive,a.isReadonly,a.isRef,a.isShallow,a.markRaw,a.nextTick,a.onActivated,a.onBeforeMount,a.onBeforeUnmount,a.onBeforeUpdate,a.onDeactivated,a.onErrorCaptured;const b=a.onMounted;a.onRenderTracked,a.onRenderTriggered,a.onScopeDispose,a.onServerPrefetch;const $=a.onUnmounted;a.onUpdated,a.provide,a.proxyRefs,a.reactive,a.readonly;const f=a.ref;a.shallowReactive,a.shallowReadonly,a.shallowRef,a.toRaw,a.toRef,a.toRefs,a.triggerRef,a.unref,a.useAttrs,a.useCssModule,a.useCssVars,a.useListeners,a.useSlots;const L=a.watch;a.watchEffect,a.watchPostEffect,a.watchSyncEffect;const S={blueprint:String,lock:[Boolean,Object],help:String,name:String,parent:String,timestamp:Number},M={__name:"heading-structure",props:S,setup(r){const e=r,t=w(),{load:s}=h(),n=f(null),o=p(()=>{var l;return(l=n.value)==null?void 0:l.some((v,g)=>{var c;return v.level>(((c=n.value[g-1])==null?void 0:c.level)??0)+1})}),u=p(()=>{var l;return((l=n.value)==null?void 0:l.filter(v=>v.level===1).length)>1}),_=p(()=>{var l;return((l=n.value)==null?void 0:l.filter(v=>v.level===1).length)===0}),i=()=>s({parent:e.parent,name:e.name}).then(l=>{n.value=l.data}),m=(l,v)=>{var g;return!!(l.level>(((g=n.value[v-1])==null?void 0:g.level)??0)+1||l.level===1&&n.value[v-1]||l.level===1&&n.value.filter(c=>c.level===1).length>1)};return b(()=>{i(),t.events.on("content.save",l=>{i()})}),$(()=>t.events.off("content.save")),{__sfc:!0,props:e,panel:t,load:s,data:n,incorrectOrder:o,multipleH1:u,noH1:_,handleLoad:i,itemInvalid:m}}};var N=function(){var e=this,t=e._self._c,s=e._self._setupProxy;return s.data?t("div",{staticClass:"k-section k-heading-structure"},[t("div",{staticClass:"k-field-header k-heading-structure__label k-label k-field-label"},[t("k-icon",{attrs:{type:"headline"}}),t("span",{staticClass:"k-label-text"},[e._v(e._s(s.props.label||e.$t("seo.sections.headingStructure.title")))])],1),t("k-box",{attrs:{theme:"white"}},[t("ol",{staticClass:"k-heading-structure__list"},e._l(s.data,function(n,o){return t("li",{key:o,class:`k-heading-structure__item level-${n.level} ${s.itemInvalid(n,o)?"is-invalid":""}`,style:`z-index: ${s.data.length-o}`},[t("span",{staticClass:"k-heading-structure__item__level"},[e._v(" H"+e._s(n.level)+" ")]),t("span",{staticClass:"k-heading-structure__item__text"},[e._v(e._s(n.text))])])}),0)]),s.incorrectOrder&&!s.noH1?t("k-box",{staticClass:"k-heading-structure__notice",attrs:{theme:"negative"}},[t("k-icon",{attrs:{type:"alert"}}),t("k-text",[e._v(e._s(e.$t("seo.sections.headingStructure.errors.incorrectOrder")))])],1):e._e(),s.multipleH1?t("k-box",{staticClass:"k-heading-structure__notice",attrs:{theme:"negative"}},[t("k-icon",{attrs:{type:"alert"}}),t("k-text",[e._v(e._s(e.$t("seo.sections.headingStructure.errors.multipleH1")))])],1):e._e(),s.noH1?t("k-box",{staticClass:"k-heading-structure__notice",attrs:{theme:"negative"}},[t("k-icon",{attrs:{type:"alert"}}),t("k-text",[e._v(e._s(e.$t("seo.sections.headingStructure.errors.missingH1")))])],1):e._e()],1):e._e()},U=[],Z=d(M,N,U);const A=Z.exports,D={__name:"facebook-preview",props:{ogTitle:String,url:String,ogDescription:String,ogImage:String},setup(r){const e=r,t=p(()=>new window.URL(e.url).host);return{__sfc:!0,props:e,host:t}}};var O=function(){var e=this,t=e._self._c,s=e._self._setupProxy;return t("div",[t("div",{staticClass:"k-facebook-preview"},[e.ogImage?t("div",{staticClass:"k-facebook-preview__image"},[t("img",{staticClass:"k-facebook-preview__img",attrs:{src:e.ogImage}})]):e._e(),t("div",{staticClass:"k-facebook-preview__content"},[t("span",{staticClass:"k-facebook-preview__url"},[e._v(e._s(s.host))]),t("span",{staticClass:"k-facebook-preview__title"},[e._v(e._s(e.ogTitle))]),t("p",{staticClass:"k-facebook-preview__description"},[e._v(e._s(e.ogDescription))])])]),t("a",{staticClass:"k-seo-preview__debugger",attrs:{href:"https://developers.facebook.com/tools/debug/","aria-label":"Facebook Sharing Debugger",target:"_blank",rel:"noopener noreferrer"}},[e._v(" "+e._s(e.$t("seo.sections.preview.openDebugger"))+" "),t("k-icon",{attrs:{type:"open"}})],1)])},z=[],B=d(D,O,z);const E=B.exports,j={__name:"google-preview",props:{title:String,url:String,description:String,ogSiteName:String},setup(r){const e=r,t=p(()=>new window.URL(e.url).origin),s=p(()=>new window.URL(e.url).pathname),n=p(()=>new window.URL(e.url).hostname),o=p(()=>{const u=s.value;if(!u||u==="/")return"";const _=u.split("/").filter(Boolean);return _.length===0?"":_.length===1?` › ${_[0]}`:` › … › ${_[_.length-1]}`});return{__sfc:!0,props:e,origin:t,pathname:s,domain:n,breadcrumbs:o}}};var G=function(){var e=this,t=e._self._c,s=e._self._setupProxy;return t("div",[t("div",{staticClass:"k-google-search-preview"},[t("div",{staticClass:"k-google-search-preview__header"},[t("img",{staticClass:"k-google-search-preview__favicon",attrs:{src:`https://www.google.com/s2/favicons?domain=${s.domain.value}&sz=32`,alt:`${e.ogSiteName} favicon`}}),t("div",{staticClass:"k-google-search-preview__site-info"},[t("span",{staticClass:"k-google-search-preview__site-title"},[e._v(e._s(e.ogSiteName))]),t("span",{staticClass:"k-google-search-preview__url"},[e._v(" "+e._s(s.origin)+e._s(s.breadcrumbs)+" ")])])]),t("h3",{staticClass:"k-google-search-preview__title"},[e._v(e._s(e.title))]),e.description?t("p",{staticClass:"k-google-search-preview__description"},[e._v(" "+e._s(e.description)+" ")]):e._e()]),t("a",{staticClass:"k-seo-preview__debugger",attrs:{href:"https://search.google.com/search-console","aria-label":"Google Search Console",target:"_blank",rel:"noopener noreferrer"}},[e._v(" "+e._s(e.$t("seo.sections.preview.openSearchConsole"))+" "),t("k-icon",{attrs:{type:"open"}})],1)])},W=[],q=d(j,G,W);const J=q.exports,K={__name:"slack-preview",props:{ogTitle:String,ogSiteName:String,ogDescription:String,ogImage:String,url:String},setup(r){const e=r,t=p(()=>new window.URL(e.url).origin),s=p(()=>new window.URL(e.url).hostname),n=f(!0);return{__sfc:!0,props:e,origin:t,domain:s,showImage:n}}};var Q=function(){var e=this,t=e._self._c,s=e._self._setupProxy;return t("div",{staticClass:"k-slack-preview"},[t("div",{staticClass:"k-slack-preview__content"},[t("div",{staticClass:"k-slack-preview__site-name"},[t("img",{staticClass:"k-slack-preview__favicon",attrs:{src:`https://www.google.com/s2/favicons?domain=${s.domain}&sz=16`,alt:`${e.ogSiteName} favicon`}}),e._v(" "+e._s(e.ogSiteName||s.origin)+" ")]),t("span",{staticClass:"k-slack-preview__title"},[e._v(e._s(e.ogTitle))]),t("p",{staticClass:"k-slack-preview__description"},[e._v(" "+e._s(e.ogDescription)+" "),e.ogImage?t("button",{staticClass:"k-slack-preview__image-toggle",on:{click:function(n){s.showImage=!s.showImage}}},[e._v(" "+e._s(s.showImage?"▼":"▶")+" ")]):e._e()])]),e.ogImage&&s.showImage?t("div",{staticClass:"k-slack-preview__image"},[t("img",{attrs:{src:e.ogImage}})]):e._e()])},X=[],Y=d(K,Q,X);const ee=Y.exports,te={__name:"seo-preview",props:S,setup(r){const e=r,t=w(),s=F(),{load:n}=h(),o=f(null),u=f([]),_=p(()=>e.parent==="site"),i=p(()=>{var c;return e.label||((c=t==null?void 0:t.t)==null?void 0:c.call(t,"seo.sections.preview.title"))||"Preview"}),m=p(()=>{var C;const c=(C=o.value)==null?void 0:C.pageTitle;if(_.value&&c){const oe=c.replaceAll('"','\\"');return`${i.value} (shows "${oe}")`}return i.value}),l=f(window.localStorage.getItem("kSEOPreviewType")??"google");L(l,c=>{window.localStorage.setItem("kSEOPreviewType",c)});const v=()=>{n({parent:e.parent,name:e.name}).then(c=>{o.value=c.meta,u.value=c.options,!window.localStorage.getItem("kSEOPreviewType")&&c.options.length>0&&(l.value=c.options[0].value)})},g=()=>{var c;(c=o.value)!=null&&c.panelUrl&&s.$go(o.value.panelUrl)};return b(()=>{v(),t.events.on("content.save",c=>{v()})}),$(()=>t.events.off("content.save")),{__sfc:!0,props:e,panel:t,app:s,load:n,meta:o,options:u,isSiteParent:_,baseLabel:i,headerLabel:m,type:l,handleLoad:v,openPanelTarget:g,FacebookPreview:E,GooglePreview:J,SlackPreview:ee}}};var se=function(){var n;var e=this,t=e._self._c,s=e._self._setupProxy;return t("div",{staticClass:"k-section k-seo-preview"},[t("div",{staticClass:"k-field-header k-seo-preview__label k-label k-field-label"},[t("k-icon",{attrs:{type:"preview"}}),t("span",{staticClass:"k-label-text"},[e._v(" "+e._s(s.headerLabel)+" ")]),s.isSiteParent&&((n=s.meta)!=null&&n.panelUrl)?t("k-button",{staticClass:"k-seo-preview__panel-button",attrs:{variant:"filled",size:"xs",icon:"edit"},on:{click:s.openPanelTarget}},[e._v(" View page in panel ")]):e._e()],1),t("k-select-field",{attrs:{type:"select",name:"seo-preview-type",before:e.$t("seo.sections.preview.showFor"),options:s.options,required:!0,empty:!1},model:{value:s.type,callback:function(o){s.type=o},expression:"type"}}),s.meta?t("div",{staticClass:"k-seo-preview__inner"},[s.type==="google"?t(s.GooglePreview,e._b({},"google-preview",s.meta,!1)):e._e(),s.type==="facebook"?t(s.FacebookPreview,e._b({},"facebook-preview",s.meta,!1)):e._e(),s.type==="slack"?t(s.SlackPreview,e._b({},"slack-preview",s.meta,!1)):e._e()],1):e._e()],1)},ae=[],ne=d(te,se,ae);const re=ne.exports;panel.plugin("tobimori/seo",{icons:{robots:'<path d="M13.5 2c0 .444-.193.843-.5 1.118V5h5a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V8a3 3 0 0 1 3-3h5V3.118A1.5 1.5 0 1 1 13.5 2ZM6 7a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1H6Zm-4 3H0v6h2v-6Zm20 0h2v6h-2v-6ZM9 14.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm6 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z" />',"robots-off":'<path fill-rule="evenodd" clip-rule="evenodd" d="M21 16.786V8a3 3 0 0 0-3-3h-5V3.118a1.5 1.5 0 1 0-2 0V5H9.214l2 2H18a1 1 0 0 1 1 1v6.786l2 2ZM2.093 3.507l2.099 2.099A2.995 2.995 0 0 0 3 8v10a3 3 0 0 0 3 3h12c.463 0 .902-.105 1.293-.292l1.9 1.9 1.414-1.415-6.88-6.88a1.5 1.5 0 1 0-2.04-2.04L3.508 2.093 2.093 3.507ZM5 8a1 1 0 0 1 .65-.937L17.585 19H6a1 1 0 0 1-1-1V8Zm-5 2h2v6H0v-6Zm24 0h-2v6h2v-6Zm-13.5 3a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z" />'},sections:{"heading-structure":A,"seo-preview":re},fields:{"seo-writer":P},components:{"k-seo-writer-input":V},writerNodes:{seoTemplateTitle:k({name:"seoTemplateTitle",icon:"page",variable:"title",label:"seo.writerNodes.template.title",theme:"blue"}),seoTemplateSiteTitle:k({name:"seoTemplateSiteTitle",icon:"globe",variable:"site.title",label:"seo.writerNodes.template.siteTitle",theme:"purple"})}})})();
