(function(){"use strict";function f(o,e,t,s,a,n,u,i){var l=typeof o=="function"?o.options:o;return e&&(l.render=e,l.staticRenderFns=t,l._compiled=!0),{exports:o,options:l}}const D={extends:"k-writer-field",props:{ai:[String,Boolean]},data(){return{aiStreaming:!1,aiAbortController:null}},computed:{buttons(){if(!this.ai)return[];if(this.aiStreaming)return[{icon:"loader",text:this.$t("seo.ai.action.stop"),disabled:this.disabled||!this.aiEndpointUrl,theme:"red",click:()=>this.abortAiStream()}];const o=[{icon:this.value===""?"seo-ai":"refresh",text:this.value===""?this.$t("seo.ai.action.generate"):this.$t("seo.ai.action.regenerate"),disabled:this.disabled||!this.aiEndpointUrl,click:()=>this.startAiStream()},{icon:"cog",title:this.$t("seo.ai.action.customize"),disabled:this.disabled||!this.aiEndpointUrl,click:()=>this.openCustomizeDialog()}];return this.value!==""?[{icon:"seo-ai",text:this.$t("seo.ai.action.edit"),disabled:this.disabled||!this.aiEndpointUrl,click:()=>this.openEditDialog()},...o]:o},aiEndpointUrl(){var t,s,a;const o=(s=(t=this.$panel)==null?void 0:t.urls)==null?void 0:s.api,e=(a=this.endpoints)==null?void 0:a.field;return!o||!e?null:`${o}/${e}/ai/stream`.replace(/([^:]\/)\/+/g,"$1")}},beforeDestroy(){this.abortAiStream()},methods:{async startAiStream(o={}){var a,n,u,i;const e=this.aiEndpointUrl;if(!e||this.disabled||this.aiStreaming)return;(a=this.$refs.input)!=null&&a.focus&&this.$refs.input.focus();const t=this.getEditor();t&&t.clearContent();const s=new AbortController;this.aiAbortController=s,this.aiStreaming=!0;try{const l=await fetch(e,{method:"POST",headers:{"Content-Type":"application/json",Accept:"text/event-stream","X-CSRF":(u=(n=this.$panel)==null?void 0:n.system)==null?void 0:u.csrf,"X-Language":(i=this.$panel)==null?void 0:i.language.code},body:JSON.stringify({instructions:o.instructions,edit:o.edit}),credentials:"same-origin",signal:s.signal});if(!l.ok)try{const d=await l.json();throw new Error((d==null?void 0:d.message)||this.$t("seo.ai.error.request"))}catch{throw new Error(this.$t("seo.ai.error.request"))}if(!l.body)throw new Error(this.$t("seo.ai.error.request"));await this.consumeStream(l.body.getReader())}catch(l){if(l&&l.name==="AbortError")return;console.error(l);const d=l&&l.message?l.message:this.$t("seo.ai.error.request");this.$panel.notification.error(d)}finally{this.aiAbortController=null,this.aiStreaming=!1}},async consumeStream(o){const e=new TextDecoder;let t="";try{for(;;){const{value:s,done:a}=await o.read();if(a)break;s&&(t+=e.decode(s,{stream:!0}),t=this.processStreamBuffer(t))}t+=e.decode(),this.processStreamBuffer(t)}finally{o&&typeof o.releaseLock=="function"&&o.releaseLock()}},processStreamBuffer(o){let e=o;for(;;){const t=e.indexOf(`

`);if(t===-1)return e;const s=e.slice(0,t);if(e=e.slice(t+2),s.trim()==="")continue;const a=s.split(`
`).filter(n=>n.trim().startsWith("data:")).map(n=>n.trim().slice(5)).join(`
`).trim();a!==""&&this.handleAiEvent(a)}},handleAiEvent(o){let e=null;try{e=JSON.parse(o)}catch(t){console.error("Failed to parse AI chunk",t,o);return}if(e.type!=="text-start"){if(e.type==="text-delta"){this.applyAiDelta(e.text||"");return}if(e.type!=="thinking-delta"&&!(e.type==="tool-call"||e.type==="tool-result")&&e.type!=="stream-end"&&e.type==="error")throw new Error(e.payload&&e.payload.message?e.payload.message:this.$t("seo.ai.error.request"))}},applyAiDelta(o){if(!o)return;const e=this.getEditor();if(!e)return;const{state:t,view:s}=e;if(!t||!s)return;const a=t.doc.content.size,n=t.schema.text(o),u=t.tr.insert(a,n);s.dispatch(u)},getEditor(){var e,t;const o=(t=(e=this.$refs.input)==null?void 0:e.$refs)==null?void 0:t.input;return(o==null?void 0:o.editor)||null},abortAiStream(){this.aiAbortController&&(this.aiAbortController.abort(),this.aiAbortController=null),this.aiStreaming=!1},openEditDialog(){this.$panel.dialog.open({component:"k-form-dialog",props:{fields:{instructions:{label:this.$t("seo.ai.dialog.instructions.label"),type:"textarea",buttons:!1,placeholder:this.$t("seo.ai.dialog.instructions.placeholder"),required:!0}},submitButton:this.$t("seo.ai.dialog.edit.submit")},on:{submit:o=>{this.$panel.dialog.close(),this.startAiStream({edit:this.value,instructions:o.instructions})}}})},openCustomizeDialog(){this.$panel.dialog.open({component:"k-form-dialog",props:{fields:{instructions:{label:this.$t("seo.ai.dialog.custom.label"),type:"textarea",buttons:!1,placeholder:this.$t("seo.ai.dialog.custom.placeholder"),required:!0}},submitButton:this.$t("seo.ai.dialog.custom.submit")},on:{submit:o=>{this.$panel.dialog.close(),this.startAiStream({instructions:o.instructions})}}})}}};var I=function(){var e=this,t=e._self._c;return t("k-field",e._b({class:["k-writer-field",e.$attrs.class],style:e.$attrs.style,attrs:{counter:e.counterOptions,input:e.id},scopedSlots:e._u([e.disabled?null:{key:"options",fn:function(){return[t("k-button-group",{ref:"buttons",staticClass:"k-field-options",attrs:{buttons:e.buttons,layout:"collapsed",size:"xs",variant:"filled"}})]},proxy:!0}],null,!0)},"k-field",e.$props,!1),[t("k-input",e._b({ref:"input",attrs:{after:e.after,before:e.before,icon:e.icon,type:"seo-writer"},on:{input:function(s){return e.$emit("input",s)}}},"k-input",e.$props,!1))],1)},O=[],U=f(D,I,O);const F=U.exports,M={extends:"k-writer-input",methods:{createNodes(){return Vue.component("k-writer-input").options.methods.createNodes.call(this).filter(e=>e.name!=="hardBreak")}}};var B=function(){var e=this,t=e._self._c;return t("div",{directives:[{name:"direction",rawName:"v-direction"}],ref:"editor",class:["k-writer","k-writer-input",e.$attrs.class],style:e.$attrs.style,attrs:{"data-disabled":e.disabled,"data-empty":e.isEmpty,"data-placeholder":e.placeholder,spellcheck:e.spellcheck}},[e.editor&&!e.disabled?t("k-writer-toolbar",e._b({ref:"toolbar",on:{command:e.onCommand}},"k-writer-toolbar",e.toolbarOptions,!1)):e._e(),t("textarea",{ref:"output",staticClass:"input-hidden",attrs:{name:e.name,required:e.required,tabindex:"-1"},domProps:{value:e.value}})],1)},V=[],z=f(M,B,V);const H=z.exports,r=window.Vue;function y(){return window.panel}function L(){return y().api}function q(){return y().app}function R(){const o=L();return{load:({parent:t,name:s})=>o.get(`${t}/sections/${s}`)}}const m=r.computed;r.customRef,r.defineAsyncComponent,r.defineComponent,r.effectScope,r.getCurrentInstance,r.getCurrentScope,r.h,r.inject,r.isProxy,r.isReactive,r.isReadonly,r.isRef,r.isShallow,r.markRaw;const Z=r.nextTick;r.onActivated,r.onBeforeMount,r.onBeforeUnmount,r.onBeforeUpdate,r.onDeactivated,r.onErrorCaptured;const C=r.onMounted;r.onRenderTracked,r.onRenderTriggered,r.onScopeDispose,r.onServerPrefetch;const S=r.onUnmounted;r.onUpdated,r.provide,r.proxyRefs,r.reactive,r.readonly;const v=r.ref;r.shallowReactive,r.shallowReadonly,r.shallowRef,r.toRaw,r.toRef,r.toRefs,r.triggerRef,r.unref,r.useAttrs,r.useCssModule,r.useCssVars,r.useListeners,r.useSlots;const x=r.watch;r.watchEffect,r.watchPostEffect,r.watchSyncEffect;const j={__name:"utm-share-dialog",props:{pageUrl:{type:String,required:!0},visible:{type:Boolean,default:!0},size:{type:String,default:"medium"}},emits:["cancel"],setup(o,{emit:e}){const t=o,s=v({utm_source:"",utm_medium:"",utm_campaign:"",utm_content:"",utm_term:"",ref:""}),a=[{key:"utm_source",icon:"globe",name:"source"},{key:"utm_medium",icon:"dashboard",name:"medium"},{key:"utm_campaign",icon:"megaphone",name:"campaign"},{key:"utm_content",icon:"image",name:"content"},{key:"utm_term",icon:"search",name:"term"},{key:"ref",icon:"url",name:"ref"}],n=v(!1),u=v(null),i=m(()=>{const c=new URL(t.pageUrl);for(const p of a)s.value[p.key]&&c.searchParams.set(p.key,s.value[p.key]);return c.toString()}),l=async()=>{try{await navigator.clipboard.writeText(i.value),n.value=!0,setTimeout(()=>{n.value=!1},2e3)}catch(c){console.error("Failed to copy:",c)}};x(i,()=>{Z(()=>{u.value&&(u.value.scrollLeft=u.value.scrollWidth)})});const d=c=>{var p;t.visible&&(c.ctrlKey||c.metaKey)&&c.key==="c"&&!((p=window.getSelection())!=null&&p.toString())&&(c.preventDefault(),l())};return C(()=>{document.addEventListener("keydown",d)}),S(()=>{document.removeEventListener("keydown",d)}),{__sfc:!0,props:t,emit:e,params:s,fields:a,copied:n,urlInput:u,generatedUrl:i,copyToClipboard:l,handleKeydown:d}}};var W=function(){var e=this,t=e._self._c,s=e._self._setupProxy;return t("k-dialog",{staticClass:"k-seo-utm-share-dialog",attrs:{size:e.size,visible:e.visible,"cancel-button":!1,"submit-button":!1},on:{cancel:function(a){return s.emit("cancel")}},scopedSlots:e._u([{key:"header",fn:function(){return[t("k-button",{staticClass:"k-seo-utm-share-dialog__close",attrs:{icon:"cancel"},on:{click:function(a){return s.emit("cancel")}}})]},proxy:!0}])},[t("div",{staticClass:"k-seo-utm-share-dialog__url-wrapper"},[t("k-label",{staticClass:"k-seo-utm-share-dialog__section-label"},[e._v(e._s(e.$t("seo.utmShare.button")))]),t("div",{staticClass:"k-input k-seo-utm-share-dialog__url"},[t("span",{staticClass:"k-input-element"},[t("input",{ref:"urlInput",staticClass:"k-string-input",attrs:{id:"generated-url",type:"text",readonly:"","data-font":"monospace"},domProps:{value:s.generatedUrl},on:{focus:function(a){return a.target.select()}}})]),t("k-button",{staticClass:"k-seo-utm-share-dialog__copy",attrs:{icon:s.copied?"check":"copy",theme:s.copied?"positive":"notice",variant:"filled"},on:{click:s.copyToClipboard}})],1)],1),t("k-label",{staticClass:"k-seo-utm-share-dialog__section-label"},[e._v(e._s(e.$t("seo.utmShare.parameters")))]),t("div",{staticClass:"k-seo-utm-share-dialog__params"},e._l(s.fields,function(a){return t("div",{key:a.key,staticClass:"k-seo-utm-share-dialog__row"},[t("label",{staticClass:"k-seo-utm-share-dialog__label",attrs:{for:a.key}},[t("k-icon",{attrs:{type:a.icon}}),e._v(" "+e._s(e.$t(`seo.utmShare.${a.name}.label`))+" ")],1),t("k-input",{staticClass:"k-seo-utm-share-dialog__input"},[t("k-text-input",{attrs:{id:a.key,placeholder:e.$t(`seo.utmShare.${a.name}.placeholder`)},model:{value:s.params[a.key],callback:function(n){e.$set(s.params,a.key,n)},expression:"params[field.key]"}})],1)],1)}),0)],1)},G=[],K=f(j,W,G);const Y=K.exports,J={__name:"gsc-drawer",props:{columns:Object,rows:Array,parent:String,metric:String,sortAsc:Boolean,total:Number,page:Number,limit:Number,visible:Boolean,current:Boolean,icon:String,title:String,breadcrumb:Array,tabs:Object,tab:String,options:Array},emits:["cancel","crumb","submit","tab"],setup(o,{emit:e}){const t=o,s=Vue.computed(()=>({page:t.page,limit:t.limit,total:t.total,details:!0})),a=(i={})=>{window.panel.drawer.refresh({query:{metric:i.metric??t.metric,asc:i.asc??t.sortAsc?1:0,page:i.page??t.page}})};return{__sfc:!0,props:t,emit:e,pagination:s,reload:a,handlePaginate:i=>a({page:i.page}),handleHeader:({columnIndex:i})=>{const l=t.metric===i?!t.sortAsc:i==="position"||i==="query";a({metric:i,asc:l,page:1})}}}};var X=function(){var a;var e=this,t=e._self._c,s=e._self._setupProxy;return t("k-drawer",e._b({staticClass:"k-gsc-drawer",on:{cancel:function(n){return s.emit("cancel")},crumb:function(n){return s.emit("crumb",n)},submit:function(n){return s.emit("cancel")},tab:function(n){return s.emit("tab",n)}}},"k-drawer",e.$props,!1),[(a=s.props.rows)!=null&&a.length?t("k-table",{attrs:{columns:s.props.columns,rows:s.props.rows,index:!1,pagination:s.pagination},on:{header:s.handleHeader,paginate:s.handlePaginate},scopedSlots:e._u([{key:"header",fn:function({columnIndex:n,label:u}){return[t("span",[e._v(" "+e._s(u)+" "),s.props.metric===n?t("k-icon",{attrs:{type:s.props.sortAsc?"angle-up":"angle-down"}}):e._e()],1)]}}])}):t("k-box",{attrs:{theme:"empty"}},[t("k-text",[e._v(e._s(e.$t("seo.sections.searchConsole.noData")))])],1)],1)},Q=[],ee=f(J,X,Q);const te=ee.exports,A=o=>{const e={theme:"blue",...o};return{get button(){var t,s;return{id:e.name,icon:e.icon,label:(s=(t=window.panel)==null?void 0:t.$t)==null?void 0:s.call(t,e.label),name:e.name,inline:!0}},get schema(){return{group:"inline",inline:!0,atom:!0,selectable:!1,attrs:{variable:{default:e.variable}},leafText:t=>`{{ ${t.attrs.variable} }}`,parseDOM:[{tag:`span[data-seo-template-variable="${e.variable}"]`,getAttrs:t=>({variable:t.dataset.seoTemplateVariable??e.variable})}],toDOM:t=>["span",{"data-seo-template-variable":t.attrs.variable},`{{ ${t.attrs.variable} }}`]}},commands({type:t}){return()=>(s,a)=>{if(!a)return!1;const{from:n,to:u}=s.selection,i=t.create({variable:e.variable}),l=s.tr;l.delete(n,u),l.insert(n,i),l.insertText(" ",n+i.nodeSize);const d=s.selection.constructor,c=n+i.nodeSize+1;return l.setSelection(d.near(l.doc.resolve(c))),a(l.scrollIntoView()),!0}},view(t){var a,n;const s=document.createElement("span");return s.className="k-seo-template-variable",s.dataset.theme=e.theme,s.dataset.seoTemplateVariable=t.attrs.variable,s.setAttribute("contenteditable","false"),s.textContent=(n=(a=window.panel)==null?void 0:a.$t)==null?void 0:n.call(a,e.label),{dom:s,update(u){var i,l;return s.dataset.seoTemplateVariable=u.attrs.variable,s.textContent=(l=(i=window.panel)==null?void 0:i.$t)==null?void 0:l.call(i,e.label),!0},ignoreMutation:()=>!0}}}},T={blueprint:String,lock:[Boolean,Object],help:String,name:String,parent:String,timestamp:Number},se={__name:"heading-structure",props:T,setup(o){const e=o,t=y(),{load:s}=R(),a=v(null),n=m(()=>{var c;return(c=a.value)==null?void 0:c.some((p,k)=>{var _;return p.level>(((_=a.value[k-1])==null?void 0:_.level)??0)+1})}),u=m(()=>{var c;return((c=a.value)==null?void 0:c.filter(p=>p.level===1).length)>1}),i=m(()=>{var c;return((c=a.value)==null?void 0:c.filter(p=>p.level===1).length)===0}),l=()=>s({parent:e.parent,name:e.name}).then(c=>{a.value=c.data}),d=(c,p)=>{var k;return!!(c.level>(((k=a.value[p-1])==null?void 0:k.level)??0)+1||c.level===1&&a.value[p-1]||c.level===1&&a.value.filter(_=>_.level===1).length>1)};return C(()=>{l(),t.events.on("content.save",c=>{l()})}),S(()=>t.events.off("content.save")),{__sfc:!0,props:e,panel:t,load:s,data:a,incorrectOrder:n,multipleH1:u,noH1:i,handleLoad:l,itemInvalid:d}}};var ae=function(){var e=this,t=e._self._c,s=e._self._setupProxy;return s.data?t("div",{staticClass:"k-section k-heading-structure"},[t("div",{staticClass:"k-field-header k-heading-structure__label k-label k-field-label"},[t("k-icon",{attrs:{type:"headline"}}),t("span",{staticClass:"k-label-text"},[e._v(e._s(s.props.label||e.$t("seo.sections.headingStructure.title")))])],1),t("k-box",{attrs:{theme:"white"}},[t("ol",{staticClass:"k-heading-structure__list"},e._l(s.data,function(a,n){return t("li",{key:n,class:`k-heading-structure__item level-${a.level} ${s.itemInvalid(a,n)?"is-invalid":""}`,style:`z-index: ${s.data.length-n}`},[t("span",{staticClass:"k-heading-structure__item__level"},[e._v(" H"+e._s(a.level)+" ")]),t("span",{staticClass:"k-heading-structure__item__text"},[e._v(e._s(a.text))])])}),0)]),s.incorrectOrder&&!s.noH1?t("k-box",{staticClass:"k-heading-structure__notice",attrs:{theme:"negative"}},[t("k-icon",{attrs:{type:"alert"}}),t("k-text",[e._v(e._s(e.$t("seo.sections.headingStructure.errors.incorrectOrder")))])],1):e._e(),s.multipleH1?t("k-box",{staticClass:"k-heading-structure__notice",attrs:{theme:"negative"}},[t("k-icon",{attrs:{type:"alert"}}),t("k-text",[e._v(e._s(e.$t("seo.sections.headingStructure.errors.multipleH1")))])],1):e._e(),s.noH1?t("k-box",{staticClass:"k-heading-structure__notice",attrs:{theme:"negative"}},[t("k-icon",{attrs:{type:"alert"}}),t("k-text",[e._v(e._s(e.$t("seo.sections.headingStructure.errors.missingH1")))])],1):e._e()],1):e._e()},oe=[],re=f(se,ae,oe);const ne=re.exports,ie={__name:"facebook-preview",props:{ogTitle:String,url:String,ogDescription:String,ogImage:String},setup(o){const e=o,t=m(()=>new window.URL(e.url).host);return{__sfc:!0,props:e,host:t}}};var le=function(){var e=this,t=e._self._c,s=e._self._setupProxy;return t("div",[t("div",{staticClass:"k-facebook-preview"},[e.ogImage?t("div",{staticClass:"k-facebook-preview__image"},[t("img",{staticClass:"k-facebook-preview__img",attrs:{src:e.ogImage}})]):e._e(),t("div",{staticClass:"k-facebook-preview__content"},[t("span",{staticClass:"k-facebook-preview__url"},[e._v(e._s(s.host))]),t("span",{staticClass:"k-facebook-preview__title"},[e._v(e._s(e.ogTitle))]),t("p",{staticClass:"k-facebook-preview__description"},[e._v(e._s(e.ogDescription))])])]),t("a",{staticClass:"k-seo-preview__debugger",attrs:{href:"https://developers.facebook.com/tools/debug/","aria-label":"Facebook Sharing Debugger",target:"_blank",rel:"noopener noreferrer"}},[e._v(" "+e._s(e.$t("seo.sections.preview.openDebugger"))+" "),t("k-icon",{attrs:{type:"open"}})],1)])},ce=[],ue=f(ie,le,ce);const pe=ue.exports,de={__name:"google-preview",props:{title:String,url:String,description:String,ogSiteName:String},setup(o){const e=o,t=m(()=>new window.URL(e.url).origin),s=m(()=>new window.URL(e.url).pathname),a=m(()=>new window.URL(e.url).hostname),n=m(()=>{const u=s.value;if(!u||u==="/")return"";const i=u.split("/").filter(Boolean);return i.length===0?"":i.length===1?` › ${i[0]}`:` › … › ${i[i.length-1]}`});return{__sfc:!0,props:e,origin:t,pathname:s,domain:a,breadcrumbs:n}}};var _e=function(){var e=this,t=e._self._c,s=e._self._setupProxy;return t("div",{staticClass:"k-google-search-preview"},[t("div",{staticClass:"k-google-search-preview__header"},[t("img",{staticClass:"k-google-search-preview__favicon",attrs:{src:`https://www.google.com/s2/favicons?domain=${s.domain}&sz=32`,alt:`${e.ogSiteName} favicon`}}),t("div",{staticClass:"k-google-search-preview__site-info"},[t("span",{staticClass:"k-google-search-preview__site-title"},[e._v(e._s(e.ogSiteName))]),t("span",{staticClass:"k-google-search-preview__url"},[e._v(" "+e._s(s.origin)+e._s(s.breadcrumbs)+" ")])])]),t("h3",{staticClass:"k-google-search-preview__title"},[e._v(e._s(e.title))]),e.description?t("p",{staticClass:"k-google-search-preview__description"},[e._v(" "+e._s(e.description)+" ")]):e._e()])},me=[],ve=f(de,_e,me);const fe=ve.exports,he={__name:"slack-preview",props:{ogTitle:String,ogSiteName:String,ogDescription:String,ogImage:String,url:String},setup(o){const e=o,t=m(()=>new window.URL(e.url).origin),s=m(()=>new window.URL(e.url).hostname),a=v(!0);return{__sfc:!0,props:e,origin:t,domain:s,showImage:a}}};var ge=function(){var e=this,t=e._self._c,s=e._self._setupProxy;return t("div",{staticClass:"k-slack-preview"},[t("div",{staticClass:"k-slack-preview__content"},[t("div",{staticClass:"k-slack-preview__site-name"},[t("img",{staticClass:"k-slack-preview__favicon",attrs:{src:`https://www.google.com/s2/favicons?domain=${s.domain}&sz=16`,alt:`${e.ogSiteName} favicon`}}),e._v(" "+e._s(e.ogSiteName||s.origin)+" ")]),t("span",{staticClass:"k-slack-preview__title"},[e._v(e._s(e.ogTitle))]),t("p",{staticClass:"k-slack-preview__description"},[e._v(" "+e._s(e.ogDescription)+" "),e.ogImage?t("button",{staticClass:"k-slack-preview__image-toggle",on:{click:function(a){s.showImage=!s.showImage}}},[e._v(" "+e._s(s.showImage?"▼":"▶")+" ")]):e._e()])]),e.ogImage&&s.showImage?t("div",{staticClass:"k-slack-preview__image"},[t("img",{attrs:{src:e.ogImage}})]):e._e()])},ke=[],be=f(he,ge,ke);const we=be.exports,ye={__name:"seo-preview",props:T,setup(o){const e=o,t=y(),s=q(),{load:a}=R(),n=v(null),u=v([]),i=m(()=>e.parent==="site"),l=m(()=>e.label||t.t("seo.sections.preview.title")),d=m(()=>{var E;const _=(E=n.value)==null?void 0:E.pageTitle;return i.value&&_?t.t("seo.sections.preview.titleWithPage",{title:_}):l.value}),c=v(window.localStorage.getItem("kSEOPreviewType")??"google");x(c,_=>{window.localStorage.setItem("kSEOPreviewType",_)});const p=()=>{a({parent:e.parent,name:e.name}).then(_=>{n.value=_.meta,u.value=_.options,!window.localStorage.getItem("kSEOPreviewType")&&_.options.length>0&&(c.value=_.options[0].value)})},k=()=>{var _;(_=n.value)!=null&&_.panelUrl&&s.$go(n.value.panelUrl)};return C(()=>{p(),t.events.on("content.save",_=>{p()})}),S(()=>t.events.off("content.save")),{__sfc:!0,props:e,panel:t,app:s,load:a,meta:n,options:u,isSiteParent:i,baseLabel:l,headerLabel:d,type:c,handleLoad:p,openPanelTarget:k,FacebookPreview:pe,GooglePreview:fe,SlackPreview:we}}};var Ce=function(){var e=this,t=e._self._c,s=e._self._setupProxy;return s.meta?t("k-section",{staticClass:"k-seo-preview"},[t("div",{staticClass:"k-field-header k-seo-preview__label k-label k-field-label"},[t("k-icon",{attrs:{type:"preview"}}),t("span",{staticClass:"k-label-text"},[e._v(" "+e._s(s.headerLabel)+" ")]),s.isSiteParent&&s.meta.panelUrl?t("k-button",{staticClass:"k-seo-preview__panel-button",attrs:{variant:"filled",size:"xs",icon:"edit"},on:{click:s.openPanelTarget}},[e._v(" "+e._s(e.$t("seo.sections.preview.viewPage"))+" ")]):e._e()],1),t("k-select-field",{attrs:{type:"select",name:"seo-preview-type",before:e.$t("seo.sections.preview.showFor"),options:s.options,required:!0,empty:!1},model:{value:s.type,callback:function(a){s.type=a},expression:"type"}}),t("div",{staticClass:"k-seo-preview__inner"},[s.type==="google"?t(s.GooglePreview,e._b({},"google-preview",s.meta,!1)):e._e(),s.type==="facebook"?t(s.FacebookPreview,e._b({},"facebook-preview",s.meta,!1)):e._e(),s.type==="slack"?t(s.SlackPreview,e._b({},"slack-preview",s.meta,!1)):e._e()],1)],1):e._e()},$e=[],Se=f(ye,Ce,$e);const xe=Se.exports,Te={__name:"search-console",props:T,setup(o){const e=o,t={NO_CREDENTIALS:"seo.sections.searchConsole.noCredentials",NOT_CONNECTED:"seo.sections.searchConsole.notConnected",SELECT_PROPERTY:"seo.sections.searchConsole.selectProperty"},s=y(),a=L(),n=v(null),u=v([]),i=v("clicks"),l=v(null),d=v("clicks"),c=[{value:"clicks",text:s.t("seo.sections.searchConsole.clicks")},{value:"impressions",text:s.t("seo.sections.searchConsole.impressions")},{value:"ctr",text:s.t("seo.sections.searchConsole.ctr")},{value:"position",text:s.t("seo.sections.searchConsole.position")}],p=async()=>{const h=await a.get(`${e.parent}/sections/${e.name}`,{metric:d.value,limit:10});n.value=h.status,u.value=h.data??[],i.value=d.value};return x(d,()=>p()),C(()=>{p(),s.events.on("gsc.propertySelected",()=>{p()})}),{__sfc:!0,MESSAGES:t,props:e,panel:s,api:a,status:n,data:u,displayMetric:i,dropdown:l,metric:d,metricOptions:c,handleLoad:p,getBarWidth:h=>{if(!u.value.length)return 0;const b=i.value,w=u.value.map(Ae=>Ae[b]),g=Math.min(...w),$=Math.max(...w),N=h[b];if($===g)return 100;let P;return b==="position"?P=($-N)/($-g):P=(N-g)/($-g),10+P*90},formatValue:h=>{const b=i.value,w=h[b],g=s.translation.code;return b==="ctr"?new Intl.NumberFormat(g,{style:"percent",minimumFractionDigits:1,maximumFractionDigits:1}).format(w):b==="position"?new Intl.NumberFormat(g,{minimumFractionDigits:1,maximumFractionDigits:1}).format(w):new Intl.NumberFormat(g).format(w)},handleConnect:()=>{const h=encodeURIComponent(window.location.href);window.location.href=`/__seo/gsc/auth?return=${h}`},handleSelectProperty:()=>s.dialog.open("seo/gsc/select-property")}}};var Ee=function(){var e=this,t=e._self._c,s=e._self._setupProxy;return s.status?t("k-section",{staticClass:"k-search-console-section"},[t("div",{staticClass:"k-field-header k-seo-preview__label k-label k-field-label"},[t("k-icon",{attrs:{type:"google"}}),t("span",{staticClass:"k-label-text"},[e._v(" "+e._s(e.label||"Google Search Console")+" ")]),s.status==="CONNECTED"?t("k-button-group",{staticClass:"k-search-console__options",attrs:{layout:"collapsed"}},[t("k-button",{attrs:{size:"xs",variant:"filled",icon:"table"},on:{click:function(a){return s.panel.drawer.open(`seo/gsc/data/${s.props.parent}`,{query:{metric:s.metric}})}}},[e._v(" "+e._s(e.$t("seo.sections.searchConsole.showMore"))+" ")]),t("k-button",{attrs:{icon:"dots",size:"xs",variant:"filled"},on:{click:function(a){return s.dropdown.toggle()}}}),t("k-dropdown-content",{ref:"dropdown",attrs:{"align-x":"end"}},[t("k-dropdown-item",{attrs:{icon:"list-bullet"},on:{click:s.handleSelectProperty}},[e._v(" "+e._s(e.$t("seo.sections.searchConsole.selectPropertyButton"))+" ")]),t("k-dropdown-item",{attrs:{icon:"refresh"},on:{click:s.handleConnect}},[e._v(" "+e._s(e.$t("seo.sections.searchConsole.reconnect"))+" ")])],1)],1):e._e()],1),s.status!=="CONNECTED"?t("k-box",{staticClass:"k-search-console-empty",attrs:{align:"center",theme:"empty"}},[t("k-text",[e._v(e._s(e.$t(s.MESSAGES[s.status])))]),t("k-button-group",[s.status==="NO_CREDENTIALS"?t("k-button",{attrs:{size:"sm",variant:"filled",icon:"page",link:"https://plugins.andkindness.com/seo/docs/get-started/feature-overview",target:"_blank"}},[e._v(" "+e._s(e.$t("seo.sections.searchConsole.docs"))+" ")]):e._e(),s.status==="NOT_CONNECTED"?t("k-button",{attrs:{size:"sm",variant:"filled",icon:"google"},on:{click:s.handleConnect}},[e._v(" "+e._s(e.$t("seo.sections.searchConsole.connect"))+" ")]):e._e(),s.status==="SELECT_PROPERTY"?t("k-button",{attrs:{size:"sm",variant:"filled",theme:"positive",icon:"list-bullet"},on:{click:s.handleSelectProperty}},[e._v(" "+e._s(e.$t("seo.sections.searchConsole.selectPropertyButton"))+" ")]):e._e(),s.status==="SELECT_PROPERTY"?t("k-button",{attrs:{size:"sm",variant:"filled",icon:"refresh"},on:{click:s.handleConnect}},[e._v(" "+e._s(e.$t("seo.sections.searchConsole.reconnect"))+" ")]):e._e()],1)],1):[t("k-select-field",{attrs:{type:"select",name:"gsc-metric",before:e.$t("seo.sections.searchConsole.sortBy"),options:s.metricOptions,required:!0,empty:!1},model:{value:s.metric,callback:function(a){s.metric=a},expression:"metric"}}),t("div",{staticClass:"k-search-console__inner"},[s.data.length?t("div",{staticClass:"k-search-console__list"},e._l(s.data,function(a){return t("div",{key:a.keys[0],staticClass:"k-search-console__row"},[t("div",{staticClass:"k-search-console__bar",style:{width:s.getBarWidth(a)+"%"}}),t("span",{staticClass:"k-search-console__query"},[e._v(e._s(a.keys[0]))]),t("span",{staticClass:"k-search-console__value"},[e._v(e._s(s.formatValue(a)))])])}),0):t("k-box",{staticClass:"k-search-console-empty",attrs:{theme:"empty"}},[t("k-text",[e._v(e._s(e.$t("seo.sections.searchConsole.noData")))])],1)],1),t("a",{staticClass:"k-search-console__link",attrs:{href:"https://search.google.com/search-console",target:"_blank",rel:"noopener noreferrer"}},[e._v(" "+e._s(e.$t("seo.sections.searchConsole.openInGsc"))+" "),t("k-icon",{attrs:{type:"open"}})],1)]],2):e._e()},Pe=[],Le=f(Te,Ee,Pe);const Re=Le.exports;panel.plugin("tobimori/seo",{icons:{"seo-ai":'<path d="M16.4356 3.21188C16.8261 2.82185 17.4592 2.82157 17.8496 3.21188L20.6777 6.04099C21.0681 6.43152 21.0682 7.06457 20.6777 7.45505L7.2422 20.8896H3.00001V16.6475L16.4356 3.21188ZM5.00001 17.4756V18.8896H6.41407L15.7276 9.57615L14.3135 8.16208L5.00001 17.4756ZM4.5293 1.3193C4.70583 0.893505 5.29418 0.893508 5.47071 1.3193L5.72364 1.93063C6.15555 2.97342 6.96155 3.80613 7.97462 4.2568L8.69239 4.57614C9.10267 4.75896 9.10262 5.35616 8.69239 5.53903L7.93263 5.87692C6.94497 6.3162 6.15339 7.11943 5.71387 8.1279L5.4668 8.69334C5.28636 9.10747 4.71366 9.10747 4.53321 8.69334L4.28614 8.1279C3.84661 7.11943 3.05506 6.3162 2.06739 5.87692L1.30762 5.53903C0.897483 5.35617 0.897435 4.75896 1.30762 4.57614L2.0254 4.2568C3.03845 3.80614 3.84446 2.97344 4.27637 1.93063L4.5293 1.3193ZM15.7276 6.74802L17.1426 8.16208L18.5567 6.74802L17.1426 5.33395L15.7276 6.74802Z" />',robots:'<path d="M13.5 2c0 .444-.193.843-.5 1.118V5h5a3 3 0 0 1 3 3v10a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3V8a3 3 0 0 1 3-3h5V3.118A1.5 1.5 0 1 1 13.5 2ZM6 7a1 1 0 0 0-1 1v10a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V8a1 1 0 0 0-1-1H6Zm-4 3H0v6h2v-6Zm20 0h2v6h-2v-6ZM9 14.5a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Zm6 0a1.5 1.5 0 1 0 0-3 1.5 1.5 0 0 0 0 3Z" />',"robots-off":'<path fill-rule="evenodd" clip-rule="evenodd" d="M21 16.786V8a3 3 0 0 0-3-3h-5V3.118a1.5 1.5 0 1 0-2 0V5H9.214l2 2H18a1 1 0 0 1 1 1v6.786l2 2ZM2.093 3.507l2.099 2.099A2.995 2.995 0 0 0 3 8v10a3 3 0 0 0 3 3h12c.463 0 .902-.105 1.293-.292l1.9 1.9 1.414-1.415-6.88-6.88a1.5 1.5 0 1 0-2.04-2.04L3.508 2.093 2.093 3.507ZM5 8a1 1 0 0 1 .65-.937L17.585 19H6a1 1 0 0 1-1-1V8Zm-5 2h2v6H0v-6Zm24 0h-2v6h2v-6Zm-13.5 3a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0Z" />'},sections:{"heading-structure":ne,"seo-preview":xe,"seo-search-console":Re},fields:{"seo-writer":F},components:{"k-seo-writer-input":H,"k-seo-utm-share-dialog":Y,"k-gsc-drawer":te},writerNodes:{seoTemplateTitle:A({name:"seoTemplateTitle",icon:"page",variable:"title",label:"seo.writerNodes.template.title",theme:"blue"}),seoTemplateSiteTitle:A({name:"seoTemplateSiteTitle",icon:"globe",variable:"site.title",label:"seo.writerNodes.template.siteTitle",theme:"purple"})}})})();
